<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

</head>

<body>


<div id="position"></div>
<div id="acceleration"></div>


<canvas id="canvas" width="500" height="500">

</canvas>



<script>

    "use strict";


    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");


    function stringVector(x, y, z) {
        x = Math.round(x * 100) / 100
        y = Math.round(y * 100) / 100
        z = Math.round(z * 100) / 100
        return `x: ${x}, y: ${y}`
    }

    let acX = 0, acY = 0, acZ = 0;
    let posX = 0, posY = 0, posZ = 0;
    let vX = 0, vY = 0, vZ = 0;

    // In seconds
    const dt = 1 / 60

    const startT = performance.now()

    setInterval(() => {
        const ts = (performance.now() - startT) / 1000
        vX = vX + acX * dt
        vY = vY + acY * dt
        vZ = vZ + acZ * dt
        posX = posX + vX * dt
        posY = posY + vY * dt
        posZ = posZ + vZ * dt
    }, dt * 1000)

    // update divs every 200 ms

    const positionDiv = document.getElementById("position")
    const accelerationDiv = document.getElementById("acceleration")
    setInterval(()=> {
        positionDiv.innerText = `Position: ${stringVector(posX, posY, posZ)}`
        accelerationDiv.innerText = `Acceleration: ${stringVector(acX, acY, acZ)} (modulus = ${Math.sqrt(acX ** 2 + acY ** 2 + acZ ** 2).toFixed(2)})`


        const cCenterW = canvas.width / 2
        const cCenterH = canvas.height / 2
        ctx.beginPath()
        ctx.arc(cCenterW + posX, cCenterH +posY, 2, 0, 2 * Math.PI)
        ctx.stroke()
    }, 200)

    function onDeviceMotion(event) {
        console.log("capture event", event)
        const {acceleration: {x, y, z}} = event
        acX = x
        acY = y
        acZ = z
    }

    function startCapture() {
        if (
            DeviceMotionEvent &&
            typeof DeviceMotionEvent.requestPermission === "function"
        ) {
            DeviceMotionEvent.requestPermission();
           window.addEventListener("devicemotion", onDeviceMotion);
           console.log("started capturing")
        } else {
            alert("DeviceMotionEvent not supported");
        }
    }





</script>

<button onclick="startCapture()">start capture</button>

<div>With canvas</div>


</body>
</html>